# SMDR Insight - Development Conversation Context Summary

This document summarizes the core development milestones and technical decisions made during the transition from "Cute SMDR" to **SMDR Insight**.

## 1. Project Rebranding & Identity
- **Goal**: Transition from "Cute SMDR" to a professional brand: **SMDR Insight**.
- **Action**: Updated all UI strings, branding assets (logo), IPC bridge names, and internal configuration keys across the frontend (React/Zustand) and backend (Node/Electron).

## 2. Stability & Crash Resolution
- **Startup Crash**: Fixed a critical startup failure in the Linux build by disabling the Electron sandbox for the preload script and ensuring early IPC registration.
- **Connection Robustness**: Resolved intermittent disconnects during low call volume (quiet periods) by disabling idle socket timeouts in `ConnectionManager.ts`.
- **Failover Logic**: Refined the IP failover and "primary failback" polling to ensure maximum uptime across multiple PBX controllers.

## 3. Server-Optimized Deployment
- **Headless Mode**: Pivoted from an Electron-based background service to a **pure Node.js engine** (`node-server.ts`). This eliminated dependencies on graphical displays (X Server) and significantly reduced resource overhead on servers.
- **Universal Installer (v1.3)**: Developed a high-stability, user-agnostic `install.sh`. It dynamically detects the invoking user (via `$SUDO_USER`) or supports direct `root` installation, ensuring correct `chown` permissions and systemd service context on any Debian/Ubuntu machine.
- **Systemd Integration**: Configured the app as a managed service (`smdr-insight.service`) for automatic boot-start and crash recovery.

## 4. Web Interface & Remote Access
- **Network Access**: Built an Express-based Web Server into the application to provide a real-time dashboard accessible over the network (Port 3000).
- **Session Persistence**: Implemented a token-based authentication system. Added an automated initialization hook in `App.tsx` that verifies existing tokens on page load, preventing accidental redirects to the login screen on browser refresh.
- **Config Persistence**: Added API routes and a file-backed persistence mechanism (`settings.json`) so that changes made in the web UI (like Mitel IP addresses) are remembered permanently across service restarts.

## 5. Performance & Features
- **Functional Parity**: Gained 100% parity between the desktop and web interfaces, including real-time SSE event streaming and robust CSV exports.
- **Native Node Rebuilds**: Integrated automated `npm rebuild better-sqlite3` logic into the installer to guarantee binary compatibility with the server's specific Node.js version, resolving hidden startup crashes.

---
*Context finalized on 2026-02-18 for the SMDR Insight project.*
